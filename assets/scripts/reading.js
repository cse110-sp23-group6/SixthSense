import{playButtonHoverSound as e}from"./VolumeControl.js";import{EMOTIONS_TABLE as s,RE_ASK_INTERVAL_SECONDS as w,READING_TYPES as g,READINGS as u}from"./constants.js";import{copyStringToClipboard as h,encodeSearchParams as S,randomInt as p}from"./helpers.js";window.addEventListener("DOMContentLoaded",async function(){var e=document.getElementById("create-profile"),e=(null!==window.localStorage.getItem("formData")?(e.textContent="Previous Readings",e.addEventListener("click",function(){window.location.href="previous-fortunes.html"+window.location.search})):e.addEventListener("click",function(){window.location.href="newprofile.html"+window.location.search}),new URLSearchParams(window.location.search)),t=Date.now()/1e3;const n=e.get("reading"),o=(null!=n&&g.includes(n)||(window.location.href="choose-your-fortune.html"),e=document.getElementById("aura-image"),document.getElementById("reading"));var a=JSON.parse(window.localStorage.getItem("emotion1")),i=JSON.parse(window.localStorage.getItem("emotion2")),t=((null==a||null==a.emotion||t-a.timestamp>w)&&(window.location.href="emotions1.html"+window.location.search),(null==i||null==i.emotion||t-a.timestamp>w)&&(window.location.href="emotions2.html"+window.location.search),a.emotion),a=i.emotion;const r=s[t][a];window.localStorage.setItem("overallEmotion",JSON.stringify(r));let l=p(0,u[n][r].length-1),d=u[n][r][l],m=(e.src=`assets/emotion_auras/${r}.gif`,o.textContent=d,o.setAttribute("index",l.toString()),JSON.parse(window.localStorage.getItem("readings")));null==m&&(m=[]);const c=(i=(new Date).toISOString().split("T")[0].split("-"))[1]+"/"+i[2]+"/"+i[0];m.push({date:c,reading:d}),window.localStorage.setItem("readings",JSON.stringify(m)),document.getElementById("home").addEventListener("click",function(){window.location.href="index.html"}),document.getElementById("new-fortune").addEventListener("click",function(){l=p(0,u[n][r].length-1),d=u[n][r][l],o.textContent=d,o.setAttribute("index",l.toString()),m.pop(),m.push({date:c,reading:d}),localStorage.setItem("readings",JSON.stringify(m))}),document.getElementById("share").addEventListener("click",async function(){await h(""+window.location.origin+window.location.pathname.replace("reading.html","share.html")+"?"+S({readingType:n,name:null===window.localStorage.getItem("formData")||15<JSON.parse(window.localStorage.getItem("formData")).name.length?"":JSON.parse(window.localStorage.getItem("formData")).name,readingNum:o.getAttribute("index"),overallEmotion:r})),alert("Share link copied to clipboard!")}),t=document.createElement("volume-control"),document.getElementById("sound-button-container").appendChild(t)}),document.getElementById("new-fortune").addEventListener("mouseenter",e),document.getElementById("create-profile").addEventListener("mouseenter",e);